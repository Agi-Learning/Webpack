# Federate Module Dashboard

* It's got these two pie charts and those are actually Federated modules, but the host app itself is a create react app vanilla, which is really cool because when you think about it, that's going to be web pack 4. So you've got webpack 4 consuming Federated modules that are built on webpack 5. You're actually going to learn in this video how to use them in any context. Could be roll up, could be parcel, whatever you want. In this case, as long as the speaking react, you're good to go. But of course, that are modules you can use on any infrastructure. So even there, you're not so limited. Okay? next thing we're going to do is we're also going to use recoil. Because as per your request, I asked what you wanted to use for data management. He said, do you want a data manager? And in particular, recoil. So we're going to go with that. So all kinds of good stuff coming out of the community tab. Keep it up. I'm really excited about it. Okay. So first thing we're going to need to do is create a directory called web pack 5 dashboard. And then within that, we're going to create a react out Called Dashboard. Alright, let's bring up PS code and the first thing I'm going to do is split this in 2 because on 1 panel I'm going to run the create react app and in the other I'm going to run the server for the modules Dashboard modules OK, looking pretty good there Next thing we're gonna do is just remove all the Carousels on padding. Looking good.

* OK, let's go make our modules directory And then initialize the package sign and next thing we want to do is add react and react Dom And then we're going to add our support libraries. So we're going to add in Babel, and then the Babel preset for react as well as Babel loader. That's for web pack concurrently, which we're going to use to actually do two webpack watch And then a server And then web pack 5 and webpack cli. All right, everyone, let's get the package Jason So now we're gonna make a source directory and a graph 1.js file And we're going to create our graph 1 config js As for wipac now in graph one, we're just going to go and create a very, very simple react component. Something with a little bit of styling in there. nice and large so we can see it And now let's go build out our web package config. So first we're going to say that our entry point is that graph 1 file looks good. They're in a center development mode and dev tools, as well as our optimization flags. It's all pretty standard web pack stuff Here's where associated a little bit interesting. We are going to have our public path be local host 3001. So that's we're going to serve all of our modules from and then within that graph one. And so in order to accomplish that, we need to tell Webpack that its output path is disk slash graph 1 because we're going to run the server out of disk OK, add some extensions. They're going to bring in our rules. This is very standard boilerplate react, which is going to use Babel and the preset react And now here's where it gets fun. We're going to bring in our module federation plugin. This is now part of webpack 5 In the mainline And the first thing to do is going to say that the name of this thing is graph 1 scope and I'm going to switch it to graph 1 eventually, but I want to kind of point out where was a scope and what's a module. So I'm going to name it scope. So I'm going to just say the name is graph 1 scope. And that matches that library. Filename will remain as remote entry. That's pretty much standard module federation. We're not going to have any remotes. Graph 1 is not going to depend on any other Federated modules. But it is going to expose the graph 1 mod. So again, the module and that's going to point in graph 1. And then we're going to share our react can on the script side. We need something to start it up. So we're going to do start graph 1 which is going to give us web pack watch on that config file So serve first creates that directory. If it doesn't exist already, and then it goes into it, and then import 3001 it runs server, which is a very simple node based server, but on the plus side it automatically has cores, so it gets there any issues of that. And then for start I'm just going to concurrently run StarCraft 1 and serve and it's fired up. And now shut it down. Take a look at this graph Hey, looks good. All right Started up and just make sure that we get. Their remote entry in the right location Okay. So now we got to go consume that somewhere.

* So let's go back to the dashboardAnd we're going to create a new function called use dynamic script. So this is just a very generic code that adds a script tag to the Dom and tells you what it's loaded. You can use this for anything. You can use this to import jquery if you want it to create two state items ready and failed. And then we're going to create the use effect hook first. We're going to look for URL and we're going to create the element for the script tag the source to the URL and then the type text javascript. So it's ac true. So I just tell you loaded it anytime. Load up that script tag for us And the effect is also going to return a function that will remove that child if it gets unmounted. Very nice. And we're going to return ready and failed. And now we're going to create a component that uses that hook. It's going to be called remote react component. So we're going to give it the URL, which would be that remote entry as well as the scope, which was graph 1 scope and module, which is graph 1 mod. But now we're going to take those props so we can have use this remote react component for anything. And we're also going to take anything over that and just assign to props. So let's fire up our use dynamic script hook, get ready and failed. And I'm just going to open up, grab one config over here so that we can go and So let's continue on with our remote react component. We're just going to return some rando stuff if we were not ready or we failed And then we're going to find component. So component is going to be a lazy component and it's going to wait on Windows scope And the module within it to get a factory back. And that's that returns a promise that gives you back a factory. And then we're going to instantiate that factory that's going to go us back a module. So once the code has been loaded, meaning it's ready, then we're going to go and use this component to go and get the factory and then return from that the module So let's go try it out. Let's go get our url. Looking good And then we're going to set the module and the scope. So let's go get the module one scope. Just make sure. Graph on mod and graph on scope. Cool And now it's fired up Okay So now it's going to make a change, just to see if it's live, because we're watching it. So we'll just change that to woohoo. Refresh and Woohoo. Okay, cool. Is that giving us a live reload? But that's, that's fine. It is doing the watch, which is important.

* So next thing we're going to do is we're going to Right? Are we really getting react So let's fire this up And refresh. And no, this is not working. So what is it telling us? It's telling us that you might have more than one copy of react in the same app. Oh no So what are we going to do? I'm going to show you what the fix is and then we're going to talk about it. So up here, we're going to add in if ready. Go and get the global wet pack require and the O item on that. And then for that scope, for graph 1 scope, you're going to set its overrides to basically tell it that we already have react. It's going to give it O, but we're all going to give it another object as well. Where the key is react. And that's going to return essentially a factory. But it's going to pull our react. Okay. So let's hold up here and talk about this for a second So what's happening is this on the Federated module side, we're going creating essentially this big bundle right and is managed by remote entry And it's God react. So we're then dynamically loading that room entry, and then it's giving us back a factory. And we're initializing, we're firing off that factory, and we're saying, go for it. Give us a module back. And in that process That Federated module run remote entry is saying, hey, do I have react already and it doesn't. It doesn't know anything about the host environment And you know, we're also just going to add react on them in there too Also, I just wanted to say that if this is your first exposure to Federated modules, this video, and you're like, Oh my God, this is what it takes to actually get federally module's done. No, no, no. This is this is advanced stuff. If you're doing straight out of the box, Federated modules, web pack 5 web pack 5 you don't have to do any of this. Import handles all of this for you. So it's really easy. We're just doing some advanced hackery here. And this probably shouldn't be the first video on Federated Modules that you watch. Okay, so let's try again So now we are sharing react and also react on, although it doesn't use it And this puts us in a really good smile. So let's go remove that to that code. That was just test code to make sure that we actually had a really good react setup going. What did you do? It's great. Okay.

* So the next thing we want to do is share some data with it. So we're going to use recoil for this Very new cutting edge library from Facebook. So it's going to install recoil. We're going to install it on both sides. Add recoil to both. So what are we going to do with recoil? We're going to bring in this import. And the first thing we need to do is set up recoil root at the top level. So we're going to change Basically an app to dashboard. Current contacts of app are to become dashboard Move that over there and now we're going to bring in that recoil root in here and wrap it around dashboard. Okay. So looking good. Haven't broken anything yet.

* So now we got to create some data. So this is the data that's going to go in those charts. And in recoil world, data is modeled as an atom. Now probably going to do another video on recoil and depth because I'm fell in love with it in this video. And actually, after when I convert to 1 of my other projects to it. So, and I'm not really going to use it as much detail here We're just going to create a very simple atom called graph state, key of graph state. And then it's default value, which in this case is an array of five, 2 and 30 some random numbers. In order to use that, then we have a new hook called use recoil state. Just let use date, but you give it an atom instead of just giving it a value. Then returns a value and then a center. So it's graph and center graph Alright, so the next thing we're gonna do is just put it on the screen. OK, looking good. So now the host page at least knows what stolen data. Wow. All right,

* let's send that on to our remote react component. And as you'll remember, right, we spread props. So anything wasn't URL module or scope is going to get sent on to the component. So let's go get from there. Graph. And then also Jason Stringify it. Let's see if it's going across. Okay. Hey, wow. That was quick. Nice. Okay. Now this really gets to your architecture choice. Now I you could just have the host app just go and send the data and also maybe a change function off to the. I'm going to give it the atom. And this is just going to prove that I can use recoil on both sides of this. So I could do that on change thing, but I'm going to instead send off state with graph state, which is an atom Now I've got to import that Alright, so I gotta import use recoil state and this should work right No So it's telling us to use recoil state is not define. And also on the corresponding side on the app. Go and add it into our overrides. Let's see. Does it work? Hey, alright, now it works. Great. Okay. So this is showing us now that we have, we can share context and initialize properly. Again, you know, you get to define the api. You might not want to go and share that item like that, but that's, that's fine. It's really just showing potential. OK, so let's kind of complete this.

* And we're gonna actually set it. So we're gonna set the value to 10 20 30 and then click a buttonSo it's got this big button now. Change the data now All right, looking pretty good. Great. OK, so we've got module. We're sharing data between the application and the Federated modules. And now the next thing we want to do is share theming. So let's grab a motion It's first installed over in the app or to add motion core and a motion theming. Do the same thing essentially over on the Federated module side. And then we're going to add them to the shared We're going adding libraries, and then we add them on the shared side in the Federated Model's configuration, and then on the override side over the app. All right, so how do we use a motion? Well, first thing we're going to do is bring in a motion core on Federated module side, and we're going to use css. We're just going to replace that style with css. We're going to make a small change here, or change it to 10PX just so we can see a small change. Alright, that looks good. That line got a little bigger, showing us we actually are using emotion now. So the next thing to do would be to go over into the app, claim that import a little bit, and then bring in the theme provider from the motion theming And set up our theme. We're going to have a color scheme of green, primary color scheme of Green. So let's add in the theme provider at the same level as like recoil root And then we can go back over to our federate modules and grab in the use theme hook. That'll that gives us access to that green color if we want it. So let's grab the theme. We're gonna change that black to whatever we get as our primary color. Color is primary. So teamed up. Color is not primary. Hot pink beautiful nice. continuing on. I really want to do something nice looking.

* So let's go and bring in our last library and that's the react minimal pie chart And we'll bring that into our Federated module. And I'm just going to run it here. So basically, you just have a pie chart object. It's kind of generates some svg for us and gave it some data as well as a radius and aligned with and all that So we're going to change out the data to graph. And fired up and wow. Nice animated pie chart just like that. How cool is that Clone graph 1 config js. And change out graph 1 to graph 2. So same thing. Graph two's go. Graph 2 mod graph 2. Everything the same as graph 1 except graph 2 And we'll go and copy. All that into graph2.js So graph 2 is just going to listen. Graph one can actually make changes. Graph 2 is going to listen. Change colors so that makes more sense And change the radius in line with just a visually. a little bit different Is going to point the jsx syntax at the jsx that comes from motion. So we no longer need react. That sounds weird, but it's true. And the last thing we need to do is make a change to our scripts. Go and add graph 2 And we'll fire that back up. And does it see it work with Cisco change graph 1 to graph 2 All right, that looks different color wise. So I would say that's now graph 2. Very cool So let's now use both the components simultaneously. Crazy. We're going to put them in a grid. So side by side, grid based layout, nice little gap in between. Change graph 1 to graph 2. And now it should be side by side. Let's hit that button. All that is spectacular. So now not only. And so now, not only are they on the same page, are actually sharing that same recoil based atom. How cool is that OK, as I mentioned earlier, I'm going to change out the graph 1 scope to graph 1 and the graph 1 mod to graph 1. Let's go do that. Let's go do that for both graph 1 and graph 2. And then change out the app so that we're not adding those OK, so great. OK. And we've simplified the syntax there, right? So everything is graph 1 that is associated with graph 1. So let's go make a new component where you basically just give it the name and the props So it's just going to go and drop in name wherever we had graph one So as long as you're federally modules conform to that api Spec, where you've got the remote entry has graph 1 or whatever, the name in it, and modules the same name, and scope is the same name, then you can use this handy component that basically just give it a name. Then it gives you dashboard vision So let's try this again. So let's go ahead and change the remote react component with dashboard widget and then change out. The scope for name fire about a cup again, and looks great. Awesome OK, so all this code is available for you on Github. Check it out.

* Have some fun and let me know in the comments. Jackson for helping out on this, I couldn't have done it without you and I couldn't have done it about you and your comments in the community section of the Youtube channel. They've been great and they help make this. These videos and this channel better for it. So I'm going to keep doing it and just keep giving me your feedback. As always, on this particular video, be sure to jump down in the comments and ask any questions that you have, the stuff around web pack 5 has been great. The dialog has been awesome. So let's keep that up. And if you like the video, hit that like button. If you really like the video, be sure to hit the subscribe button and ring that bell. And you'll be notified anytime a new one of these videos comes out. Lou after 1500 subscribers. How cool is that? Thank you so much for that. And it's because you helped me make better videos. So thank you, And as always, be happy, be healthy, be safe. And I'm pretty sure by the end of this pandemic, I'm my hair is gonna be so long. Maybe like flickering. It's gonna be hilarious, right? See folks later.